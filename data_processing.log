2025-08-26 05:59:40,264 - INFO - üöÄ ENHANCED SINHALA DATASET PROCESSING
2025-08-26 05:59:40,265 - INFO - ============================================================
2025-08-26 05:59:40,265 - INFO - Configuration:
2025-08-26 05:59:40,265 - INFO -   Input file: train.json
2025-08-26 05:59:40,265 - INFO -   Model: HuggingFaceTB/SmolLM2-1.7B
2025-08-26 05:59:40,265 - INFO -   Max sequence length: 2048
2025-08-26 05:59:40,265 - INFO -   Validation split: 5.0%
2025-08-26 05:59:40,265 - INFO -   System memory: 64GB
2025-08-26 05:59:40,265 - INFO - ============================================================
2025-08-26 05:59:40,265 - INFO - 
üîÑ PROCESSING DATASET
2025-08-26 05:59:40,265 - INFO - ============================================================
2025-08-26 05:59:40,265 - INFO - Loading tokenizer: HuggingFaceTB/SmolLM2-1.7B
2025-08-26 05:59:40,649 - INFO - üìÇ Loading data from train.json
2025-08-26 05:59:44,241 - INFO - ‚úì Loaded 406,532 raw samples
2025-08-26 05:59:44,242 - INFO - ‚úì Validating samples...
2025-08-26 05:59:44,931 - INFO - ‚úì Valid samples: 406,469/406,532
2025-08-26 05:59:44,931 - INFO - üîç Removing duplicates...
2025-08-26 05:59:46,117 - INFO - ‚úì Removed 855 duplicates
2025-08-26 05:59:46,175 - INFO - ‚úì Split: 385,614 train, 20,000 validation
2025-08-26 05:59:46,175 - INFO - üìù Formatting samples...
2025-08-26 06:44:07,430 - INFO - üìä Analyzing token statistics...
2025-08-26 06:51:16,105 - INFO - 
üìä Token Statistics:
2025-08-26 06:51:16,105 - INFO -   Average tokens: 870.6
2025-08-26 06:51:16,105 - INFO -   Median tokens: 586.0
2025-08-26 06:51:16,105 - INFO -   95th percentile: 2048
2025-08-26 06:51:16,105 - INFO -   99th percentile: 2048
2025-08-26 06:51:16,105 - INFO -   Truncated samples: 9.0%
2025-08-26 06:51:16,834 - INFO - 
üíæ Saving processed datasets...
2025-08-26 06:51:17,083 - INFO -   ‚úì Training dataset saved to: data/train_dataset
2025-08-26 06:51:17,084 - INFO -   ‚úì Validation dataset saved to: data/val_dataset
2025-08-26 06:51:17,086 - INFO -   ‚úì Problematic samples saved to: data/problematic_samples.json
2025-08-26 06:51:17,086 - INFO -   ‚úì Processing report saved to: data/processing_report.txt
2025-08-26 06:51:17,087 - INFO - 
============================================================
2025-08-26 06:51:17,087 - INFO - üìä PROCESSING SUMMARY
2025-08-26 06:51:17,087 - INFO - ============================================================
2025-08-26 06:51:17,087 - INFO - Total samples: 406,532
2025-08-26 06:51:17,087 - INFO - Valid samples: 406,469 (100.0%)
2025-08-26 06:51:17,087 - INFO - Training samples: 385,614
2025-08-26 06:51:17,087 - INFO - Validation samples: 20,000
2025-08-26 06:51:17,087 - INFO - Duplicates removed: 855
2025-08-26 06:51:17,087 - INFO - Invalid samples filtered: 63
2025-08-26 06:51:17,087 - INFO - 
üìè Sequence Lengths:
2025-08-26 06:51:17,087 - INFO -   Average tokens: 871
2025-08-26 06:51:17,087 - INFO -   Max tokens: 2048
2025-08-26 06:51:17,087 - INFO -   ‚ö†Ô∏è Truncated samples: 34,551
2025-08-26 06:51:17,087 - INFO - 
üåç Language Distribution:
2025-08-26 06:51:17,087 - INFO -   Sinhala: 96.4%
2025-08-26 06:51:17,087 - INFO -   English: 1.2%
2025-08-26 06:51:17,087 - INFO -   Mixed: 2.4%
2025-08-26 06:51:17,087 - INFO - ============================================================
2025-08-26 06:51:17,087 - INFO - 
‚úÖ Data processing complete!
2025-08-26 06:51:17,087 - INFO - üìÅ Output saved to: data
2025-08-26 06:51:17,087 - INFO - Ready for training: python3 train.py
2025-08-27 03:53:47,583 - INFO - üöÄ FIXED SINHALA DATASET PROCESSING
2025-08-27 03:53:47,583 - INFO - ============================================================
2025-08-27 03:53:47,583 - INFO - Configuration:
2025-08-27 03:53:47,583 - INFO -   Input: train.json
2025-08-27 03:53:47,583 - INFO -   Model: HuggingFaceTB/SmolLM2-1.7B
2025-08-27 03:53:47,583 - INFO -   Max length: 1536
2025-08-27 03:53:47,583 - INFO - ============================================================
2025-08-27 03:53:47,583 - INFO - 
üîÑ PROCESSING DATASET WITH TOKENIZATION FIXES
2025-08-27 03:53:47,583 - INFO - ============================================================
2025-08-27 03:53:47,583 - INFO - Loading tokenizer: HuggingFaceTB/SmolLM2-1.7B
2025-08-27 03:53:47,935 - INFO - üìÇ Loading data from train.json
2025-08-27 03:53:51,739 - INFO - ‚úì Loaded 406,532 raw samples
2025-08-27 03:53:51,740 - INFO - ‚úì Validating samples...
2025-08-27 03:53:52,230 - INFO - ‚úì Valid samples: 406,469/406,532
2025-08-27 03:53:52,231 - INFO - üîç Removing duplicates...
2025-08-27 03:53:53,694 - INFO - ‚úì Removed 855 duplicates
2025-08-27 03:53:53,768 - INFO - üìù Formatting and testing tokenization...
2025-08-27 04:50:58,764 - INFO - ‚úì Successfully processed 405,614 samples
2025-08-27 04:50:58,764 - INFO -   Tokenization errors: 0
2025-08-27 04:50:58,808 - INFO - ‚úì Split: 395,614 train, 10,000 validation
2025-08-27 04:54:09,207 - INFO - 
üìä Dataset Verification:
2025-08-27 04:54:09,208 - INFO -   Sample type: <class 'str'>
2025-08-27 04:54:09,208 - INFO -   Sample preview: ### Instruction:
‡∂¥‡∑Ñ‡∂≠ ‡∂¥‡∑î‡∑Ä‡∂≠ ‡∑É‡∂Ç‡∂ö‡∑ä‡∑Ç‡∑í‡∂¥‡∑ä‡∂≠ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±:

### Input:
‡∂∂‡∑É‡∑ä‡∂±‡∑è‡∑Ñ‡∑í‡∂ª ‡∑É‡∑Ñ ‡∑É‡∂∂‡∂ª‡∂ú‡∂∏‡∑î‡∑Ä ‡∂¥‡∑Ö‡∑è‡∂≠‡∑ä ‡∑Ä‡∂Ω‡∂≠‡∑ä ‡∂ú‡∑è‡∂Ω‡∑ä‡∂Ω ‡∑É‡∑Ñ ‡∂∏‡∑è‡∂≠‡∂ª ...
2025-08-27 04:54:10,440 - INFO -   Avg tokens: 788
2025-08-27 04:54:10,440 - INFO -   Max tokens: 1536
2025-08-27 04:54:10,440 - INFO -   Min tokens: 144
2025-08-27 04:54:10,837 - INFO - 
üíæ Saving processed datasets...
2025-08-27 04:54:11,322 - INFO -   ‚úì Training dataset saved to: data/train_dataset
2025-08-27 04:54:11,343 - INFO -   ‚úì Validation dataset saved to: data/val_dataset
2025-08-27 04:54:11,343 - INFO -   ‚úì Report saved to: data/processing_report.txt
2025-08-27 04:54:11,343 - INFO - 
============================================================
2025-08-27 04:54:11,343 - INFO - ‚úÖ PROCESSING COMPLETE!
2025-08-27 04:54:11,343 - INFO - Training samples: 395,614
2025-08-27 04:54:11,343 - INFO - Validation samples: 10,000
2025-08-27 04:54:11,343 - INFO - Tokenization errors fixed: 0
2025-08-27 04:54:11,343 - INFO - ============================================================
2025-08-27 04:54:11,343 - INFO - 
üìÅ Ready for training: python3 train.py
