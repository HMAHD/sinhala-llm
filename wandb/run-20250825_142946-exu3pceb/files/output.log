
  0%|                                                                                                                                                              | 0/60395 [00:00<?, ?it/s]


















































  0%|                                                                                                                                                 | 50/60395 [05:04<102:41:56,  6.13s/it]

















































  0%|▏                                                                                                                                                | 99/60395 [10:01<100:53:19,  6.02s/it]



















































  0%|▎                                                                                                                                               | 150/60395 [15:09<102:55:35,  6.15s/it]


















































  0%|▍                                                                                                                                                | 200/60395 [20:11<95:23:20,  5.70s/it]

















































  0%|▌                                                                                                                                               | 249/60395 [25:09<101:57:11,  6.10s/it]


















































  0%|▋                                                                                                                                               | 299/60395 [30:08<103:09:19,  6.18s/it]



















































  1%|▊                                                                                                                                               | 350/60395 [35:14<101:33:16,  6.09s/it]


















































  1%|▉                                                                                                                                               | 400/60395 [40:17<103:20:19,  6.20s/it]


















































  1%|█                                                                                                                                               | 450/60395 [45:21<102:13:32,  6.14s/it]


















































  1%|█▏                                                                                                                                               | 500/60395 [50:21<99:26:46,  5.98s/it]


















































  1%|█▎                                                                                                                                               | 550/60395 [55:18<92:57:13,  5.59s/it]

















































  1%|█▍                                                                                                                                            | 599/60395 [1:00:18<100:19:55,  6.04s/it]



















































  1%|█▌                                                                                                                                             | 650/60395 [1:05:26<98:29:49,  5.94s/it]

















































  1%|█▋                                                                                                                                            | 699/60395 [1:10:29<102:15:52,  6.17s/it]


















































  1%|█▊                                                                                                                                             | 749/60395 [1:15:30<98:32:03,  5.95s/it]


















































  1%|█▍                                                                                                             | 799/60395 [1:20:33<98:38:53,  5.96s/it]



















































  1%|█▌                                                                                                             | 850/60395 [1:25:40<99:03:55,  5.99s/it]


















































  1%|█▋                                                                                                             | 900/60395 [1:30:39<98:30:40,  5.96s/it]

















































  2%|█▋                                                                                                            | 949/60395 [1:35:34<101:44:59,  6.16s/it]



















































  2%|█▊                                                                                                            | 1000/60395 [1:40:44<99:25:18,  6.03s/it]
  2%|█▊                                                                                                            | 1000/60395 [1:40:44<99:25:18,  6.03s/it]Unsloth: Not an error, but LlamaForCausalLM does not accept `num_items_in_batch`.
Using gradient accumulation will be very slightly less accurate.
Read more on gradient accumulation issues here: https://unsloth.ai/blog/gradient





















































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2498/2500 [24:11<00:01,  1.72it/s]


















































  2%|█▉                                                                                                            | 1050/60395 [2:10:00<99:25:09,  6.03s/it]


















































  2%|██                                                                                                            | 1100/60395 [2:15:02<99:04:21,  6.02s/it]

















































  2%|██                                                                                                            | 1149/60395 [2:19:56<96:06:38,  5.84s/it]



















































  2%|██▏                                                                                                           | 1200/60395 [2:25:09<99:22:26,  6.04s/it]


















































  2%|██▎                                                                                                          | 1250/60395 [2:30:10<101:46:01,  6.19s/it]

















































  2%|██▎                                                                                                           | 1299/60395 [2:35:05<98:18:54,  5.99s/it]


















































  2%|██▍                                                                                                           | 1349/60395 [2:40:08<98:17:38,  5.99s/it]


















































  2%|██▌                                                                                                           | 1399/60395 [2:45:10<99:41:34,  6.08s/it]


















































  2%|██▌                                                                                                          | 1449/60395 [2:50:09<101:53:38,  6.22s/it]


















































  2%|██▋                                                                                                           | 1499/60395 [2:55:13<99:28:21,  6.08s/it]


















































  3%|██▊                                                                                                           | 1549/60395 [3:00:13<97:35:49,  5.97s/it]


















































  3%|██▉                                                                                                           | 1599/60395 [3:05:18<99:52:56,  6.12s/it]



















































  3%|██▉                                                                                                          | 1650/60395 [3:10:31<100:43:19,  6.17s/it]
















































  3%|███                                                                                                           | 1699/60395 [3:15:24<97:20:05,  5.97s/it]


















































  3%|███▏                                                                                                         | 1749/60395 [3:20:29<100:41:43,  6.18s/it]















































  3%|███▏                                                                                                         | 1799/60395 [3:25:34<100:34:05,  6.18s/it]


















































  3%|███▎                                                                                                          | 1849/60395 [3:30:37<97:49:51,  6.02s/it]



















































  3%|███▍                                                                                                          | 1900/60395 [3:35:44<95:44:51,  5.89s/it]

















































  3%|███▌                                                                                                         | 1949/60395 [3:40:44<101:05:43,  6.23s/it]



















































  3%|███▌                                                                                                         | 2000/60395 [3:45:54<100:22:41,  6.19s/it]
{'loss': 0.4444, 'grad_norm': 0.1481708437204361, 'learning_rate': 0.0003310698906922822, 'epoch': 0.17}






















































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2499/2500 [24:14<00:00,  1.66it/s]


















































  3%|███▋                                                                                                          | 2049/60395 [4:15:09<99:15:06,  6.12s/it]



















































  3%|███▊                                                                                                          | 2100/60395 [4:20:21<94:10:07,  5.82s/it]


















































  4%|███▉                                                                                                          | 2150/60395 [4:25:27<96:42:15,  5.98s/it]


















































  4%|███▉                                                                                                         | 2200/60395 [4:30:32<100:31:42,  6.22s/it]


















































  4%|████                                                                                                          | 2250/60395 [4:35:34<99:30:57,  6.16s/it]


















































  4%|████▏                                                                                                         | 2300/60395 [4:40:41<97:27:41,  6.04s/it]


















































  4%|████▎                                                                                                         | 2350/60395 [4:45:43<99:40:10,  6.18s/it]

















































  4%|████▎                                                                                                         | 2399/60395 [4:50:39<98:43:52,  6.13s/it]


















































  4%|████▍                                                                                                         | 2449/60395 [4:55:44<95:03:56,  5.91s/it]


















































  4%|████▌                                                                                                         | 2499/60395 [5:00:44<97:45:03,  6.08s/it]


















































  4%|████▋                                                                                                         | 2549/60395 [5:05:45<98:06:59,  6.11s/it]


















































  4%|████▋                                                                                                         | 2599/60395 [5:10:48<96:45:45,  6.03s/it]


















































  4%|████▊                                                                                                         | 2649/60395 [5:15:47<97:58:11,  6.11s/it]


















































  4%|████▉                                                                                                         | 2699/60395 [5:20:52<96:40:13,  6.03s/it]


















































  5%|█████                                                                                                         | 2749/60395 [5:25:52<98:44:12,  6.17s/it]


















































  5%|█████                                                                                                         | 2799/60395 [5:30:51<97:55:19,  6.12s/it]


















































  5%|█████▏                                                                                                        | 2849/60395 [5:35:54<92:58:59,  5.82s/it]



















































  5%|█████▎                                                                                                        | 2900/60395 [5:41:02<99:33:56,  6.23s/it]


















































  5%|█████▎                                                                                                        | 2950/60395 [5:46:05<93:55:32,  5.89s/it]


















































  5%|█████▍                                                                                                        | 3000/60395 [5:51:01<89:45:32,  5.63s/it]
{'loss': 0.4161, 'grad_norm': 0.14186201989650726, 'learning_rate': 0.0004966876449155349, 'epoch': 0.25}





















































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2499/2500 [24:13<00:00,  1.66it/s]



















































  5%|█████▌                                                                                                        | 3050/60395 [6:20:16<91:23:17,  5.74s/it]


















































  5%|█████▋                                                                                                        | 3100/60395 [6:25:14<97:23:52,  6.12s/it]


















































  5%|█████▋                                                                                                        | 3150/60395 [6:30:21<98:34:59,  6.20s/it]


















































  5%|█████▊                                                                                                        | 3200/60395 [6:35:27<98:55:31,  6.23s/it]


















































  5%|█████▉                                                                                                        | 3250/60395 [6:40:29<96:56:27,  6.11s/it]


















































  5%|██████                                                                                                        | 3300/60395 [6:45:31<94:44:14,  5.97s/it]


















































  6%|██████                                                                                                        | 3350/60395 [6:50:35<96:19:25,  6.08s/it]


















































  6%|██████▏                                                                                                       | 3400/60395 [6:55:40<96:49:05,  6.12s/it]


















































  6%|██████▎                                                                                                       | 3450/60395 [7:00:43<94:44:56,  5.99s/it]


















































  6%|██████▎                                                                                                       | 3500/60395 [7:05:47<92:00:46,  5.82s/it]


















































  6%|██████▍                                                                                                       | 3550/60395 [7:10:50<97:11:55,  6.16s/it]


















































  6%|██████▌                                                                                                       | 3600/60395 [7:15:54<96:34:11,  6.12s/it]

















































  6%|██████▋                                                                                                       | 3649/60395 [7:20:53<95:03:47,  6.03s/it]


















































  6%|██████▋                                                                                                       | 3699/60395 [7:25:54<89:49:42,  5.70s/it]


















































  6%|██████▊                                                                                                       | 3749/60395 [7:30:57<95:47:34,  6.09s/it]


















































  6%|██████▉                                                                                                       | 3799/60395 [7:36:00<94:38:36,  6.02s/it]


















































  6%|███████                                                                                                       | 3849/60395 [7:41:03<96:16:47,  6.13s/it]


















































  6%|███████                                                                                                       | 3899/60395 [7:46:04<93:24:08,  5.95s/it]


















































  7%|███████▏                                                                                                      | 3949/60395 [7:51:05<94:38:21,  6.04s/it]



















































  7%|███████▎                                                                                                      | 4000/60395 [7:56:15<96:55:25,  6.19s/it]
{'loss': 0.3936, 'grad_norm': 0.10884406417608261, 'learning_rate': 0.0004914598438371444, 'epoch': 0.33}





















































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2497/2500 [24:11<00:01,  1.63it/s]


















































  7%|███████▍                                                                                                      | 4050/60395 [8:25:32<94:54:31,  6.06s/it]

















































  7%|███████▍                                                                                                      | 4099/60395 [8:30:29<96:41:59,  6.18s/it]



















































  7%|███████▌                                                                                                      | 4150/60395 [8:35:40<97:28:55,  6.24s/it]

















































  7%|███████▋                                                                                                      | 4199/60395 [8:40:40<96:25:23,  6.18s/it]



















































  7%|███████▋                                                                                                      | 4250/60395 [8:45:50<95:32:08,  6.13s/it]


















































  7%|███████▊                                                                                                      | 4300/60395 [8:50:52<92:58:28,  5.97s/it]


















































  7%|███████▉                                                                                                      | 4350/60395 [8:55:55<96:08:14,  6.18s/it]

















































  7%|████████                                                                                                      | 4399/60395 [9:00:52<95:36:47,  6.15s/it]



















































  7%|████████                                                                                                      | 4450/60395 [9:05:57<95:31:18,  6.15s/it]


















































  7%|████████▏                                                                                                     | 4500/60395 [9:10:58<96:01:30,  6.18s/it]


















































  8%|████████▎                                                                                                     | 4550/60395 [9:15:59<94:34:05,  6.10s/it]


















































  8%|████████▍                                                                                                     | 4600/60395 [9:20:56<92:47:01,  5.99s/it]


















































  8%|████████▍                                                                                                     | 4650/60395 [9:25:57<94:18:48,  6.09s/it]


















































  8%|████████▌                                                                                                     | 4700/60395 [9:31:01<93:23:13,  6.04s/it]

















































  8%|████████▋                                                                                                     | 4749/60395 [9:35:57<93:19:12,  6.04s/it]


















































  8%|████████▋                                                                                                     | 4799/60395 [9:41:00<96:05:12,  6.22s/it]


















































  8%|████████▊                                                                                                     | 4849/60395 [9:46:02<94:35:55,  6.13s/it]


















































  8%|████████▉                                                                                                     | 4899/60395 [9:51:03<85:19:08,  5.53s/it]


















































  8%|█████████                                                                                                     | 4949/60395 [9:56:05<92:04:55,  5.98s/it]


















































  8%|█████████                                                                                                    | 4999/60395 [10:01:09<95:15:23,  6.19s/it]
  8%|█████████                                                                                                    | 5000/60395 [10:01:15<94:16:39,  6.13s/it]









































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2499/2500 [24:12<00:00,  1.65it/s]

  8%|█████████                                                                                                    | 5000/60395 [10:25:29<94:16:39,  6.13s/it]/usr/local/lib/python3.10/dist-packages/peft/utils/other.py:611: UserWarning: Unable to fetch remote file due to the following error (ReadTimeoutError("HTTPSConnectionPool(host='huggingface.co', port=443): Read timed out. (read timeout=10)"), '(Request ID: 4bd5c7fb-ea0a-4759-8ded-2c5c22a0d7fa)') - silently ignoring the lookup for the file config.json in HuggingFaceTB/SmolLM2-1.7B.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in HuggingFaceTB/SmolLM2-1.7B - will assume that the vocabulary was not modified.
  warnings.warn(

















































  8%|█████████                                                                                                    | 5050/60395 [10:30:40<88:45:06,  5.77s/it]


















































  8%|█████████▏                                                                                                   | 5100/60395 [10:35:43<90:52:17,  5.92s/it]

















































  9%|█████████▎                                                                                                   | 5149/60395 [10:40:35<89:45:46,  5.85s/it]



















































  9%|█████████▍                                                                                                   | 5200/60395 [10:45:45<93:08:02,  6.07s/it]


















































  9%|█████████▍                                                                                                   | 5250/60395 [10:50:46<92:41:17,  6.05s/it]


















































  9%|█████████▌                                                                                                   | 5300/60395 [10:55:50<93:22:25,  6.10s/it]

















































  9%|█████████▋                                                                                                   | 5349/60395 [11:00:45<89:49:50,  5.87s/it]



















































  9%|█████████▋                                                                                                   | 5400/60395 [11:05:55<91:44:22,  6.01s/it]

















































  9%|█████████▊                                                                                                   | 5449/60395 [11:10:51<91:29:25,  5.99s/it]


















































  9%|█████████▉                                                                                                   | 5499/60395 [11:15:53<89:13:16,  5.85s/it]



















































  9%|██████████                                                                                                   | 5550/60395 [11:21:02<92:54:29,  6.10s/it]


















































  9%|██████████                                                                                                   | 5600/60395 [11:26:04<91:37:36,  6.02s/it]


















































  9%|██████████▏                                                                                                  | 5650/60395 [11:31:07<92:46:33,  6.10s/it]


















































  9%|██████████▎                                                                                                  | 5700/60395 [11:36:09<94:11:15,  6.20s/it]


















































 10%|██████████▍                                                                                                  | 5750/60395 [11:41:11<94:27:57,  6.22s/it]

















































 10%|██████████▍                                                                                                  | 5799/60395 [11:46:06<92:11:59,  6.08s/it]


















































 10%|██████████▌                                                                                                  | 5849/60395 [11:51:09<93:22:14,  6.16s/it]



















































 10%|██████████▋                                                                                                  | 5900/60395 [11:56:14<92:26:30,  6.11s/it]


















































 10%|█████████████▉                                                                                                                               | 5950/60395 [12:01:15<93:36:20,  6.19s/it]


















































 10%|██████████████                                                                                                                               | 6000/60395 [12:06:19<92:41:52,  6.13s/it]
{'loss': 0.366, 'grad_norm': 0.11409029364585876, 'learning_rate': 0.00047403095370886786, 'epoch': 0.5}






















































































































































































































































































































































































































































































































































































































































































































































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2498/2500 [24:13<00:01,  1.72it/s]


















































 10%|██████████████                                                                                                                               | 6050/60395 [12:35:39<90:10:37,  5.97s/it]

















































 10%|██████████████▏                                                                                                                              | 6099/60395 [12:40:40<94:01:31,  6.23s/it]



















































 10%|██████████████▎                                                                                                                              | 6150/60395 [12:45:51<92:04:51,  6.11s/it]


















































 10%|██████████████▍                                                                                                                              | 6200/60395 [12:50:58<93:30:58,  6.21s/it]

















































 10%|██████████████▌                                                                                                                              | 6249/60395 [12:55:53<91:59:10,  6.12s/it]



















































 10%|██████████████▋                                                                                                                              | 6300/60395 [13:01:01<92:38:00,  6.16s/it]


















































 11%|██████████████▊                                                                                                                              | 6350/60395 [13:06:05<87:54:51,  5.86s/it]


















































 11%|██████████████▉                                                                                                                              | 6400/60395 [13:11:09<91:48:57,  6.12s/it]


















































 11%|███████████████                                                                                                                              | 6450/60395 [13:16:13<91:59:29,  6.14s/it]


















































 11%|███████████████▏                                                                                                                             | 6500/60395 [13:21:15<90:31:27,  6.05s/it]


















































 11%|███████████████▎                                                                                                                             | 6550/60395 [13:26:15<88:55:08,  5.94s/it]


















































 11%|███████████████▍                                                                                                                             | 6600/60395 [13:31:12<90:32:34,  6.06s/it]

















































 11%|███████████████▌                                                                                                                             | 6649/60395 [13:36:08<91:14:59,  6.11s/it]


















































 11%|███████████████▋                                                                                                                             | 6699/60395 [13:41:11<90:25:08,  6.06s/it]


















































 11%|███████████████▊                                                                                                                             | 6749/60395 [13:46:14<91:03:07,  6.11s/it]


















































 11%|███████████████▊                                                                                                                             | 6799/60395 [13:51:19<91:30:52,  6.15s/it]



















































 11%|███████████████▉                                                                                                                             | 6850/60395 [13:56:27<90:24:59,  6.08s/it]

















































 11%|████████████████                                                                                                                             | 6899/60395 [14:01:25<87:32:21,  5.89s/it]


















































 12%|████████████████▏                                                                                                                            | 6949/60395 [14:06:31<92:18:15,  6.22s/it]


















































 12%|████████████████▎                                                                                                                            | 6999/60395 [14:11:33<89:42:44,  6.05s/it]
 12%|████████████████▎                                                                                                                            | 7000/60395 [14:11:39<89:58:31,  6.07s/it]














































































































































































































































  File "/workspace/sriai/train.py", line 232, in <module>                                                                                                 | 821/2500 [07:57<16:41,  1.68it/s]
    self.trainer = None
  File "/workspace/sriai/train.py", line 222, in run
    logger.info("CUDA optimizations enabled")
  File "/workspace/sriai/train.py", line 206, in train
    if torch.cuda.is_available():
  File "/workspace/sriai/unsloth_compiled_cache/UnslothSFTTrainer.py", line 738, in train
    output = super().train(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
  File "<string>", line 384, in _fast_inner_training_loop
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 3096, in _maybe_log_save_evaluate
    metrics = self._evaluate(trial, ignore_keys_for_eval)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 3045, in _evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 4154, in evaluate
    output = eval_loop(
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 4348, in evaluation_loop
    losses, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 4564, in prediction_step
    loss, outputs = self.compute_loss(model, inputs, return_outputs=True)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/_utils.py", line 1243, in _unsloth_pre_compute_loss
    outputs = self._old_compute_loss(model, inputs, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 3801, in compute_loss
    outputs = model(**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/utils/operations.py", line 820, in forward
    return model_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/utils/operations.py", line 808, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/usr/local/lib/python3.10/dist-packages/torch/amp/autocast_mode.py", line 44, in decorate_autocast
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/_compile.py", line 53, in inner
    return disable_fn(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 1372, in PeftModel_fast_forward
    return self.base_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/peft/tuners/tuners_utils.py", line 179, in forward
    return self.model.forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 1183, in _CausalLM_fast_forward
    outputs = self.model(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 995, in LlamaModel_fast_forward
    layer_outputs = decoder_layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 667, in LlamaDecoderLayer_fast_forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 541, in LlamaAttention_fast_forward
    Q, K = fast_rope_embedding(Q, K, cos, sin)
  File "/usr/local/lib/python3.10/dist-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/kernels/rope_embedding.py", line 159, in fast_rope_embedding
    torch.cuda.current_stream(Q.device).synchronize()
  File "/usr/local/lib/python3.10/dist-packages/torch/cuda/streams.py", line 102, in synchronize
    super().synchronize()
KeyboardInterrupt
Traceback (most recent call last):
  File "/workspace/sriai/train.py", line 232, in <module>
    self.trainer = None
  File "/workspace/sriai/train.py", line 222, in run
    logger.info("CUDA optimizations enabled")
  File "/workspace/sriai/train.py", line 206, in train
    if torch.cuda.is_available():
  File "/workspace/sriai/unsloth_compiled_cache/UnslothSFTTrainer.py", line 738, in train
    output = super().train(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
  File "<string>", line 384, in _fast_inner_training_loop
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 3096, in _maybe_log_save_evaluate
    metrics = self._evaluate(trial, ignore_keys_for_eval)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 3045, in _evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 4154, in evaluate
    output = eval_loop(
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 4348, in evaluation_loop
    losses, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 4564, in prediction_step
    loss, outputs = self.compute_loss(model, inputs, return_outputs=True)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/_utils.py", line 1243, in _unsloth_pre_compute_loss
    outputs = self._old_compute_loss(model, inputs, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/transformers/trainer.py", line 3801, in compute_loss
    outputs = model(**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/utils/operations.py", line 820, in forward
    return model_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/utils/operations.py", line 808, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/usr/local/lib/python3.10/dist-packages/torch/amp/autocast_mode.py", line 44, in decorate_autocast
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/_compile.py", line 53, in inner
    return disable_fn(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 1372, in PeftModel_fast_forward
    return self.base_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/peft/tuners/tuners_utils.py", line 179, in forward
    return self.model.forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 1183, in _CausalLM_fast_forward
    outputs = self.model(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 995, in LlamaModel_fast_forward
    layer_outputs = decoder_layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 667, in LlamaDecoderLayer_fast_forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/models/llama.py", line 541, in LlamaAttention_fast_forward
    Q, K = fast_rope_embedding(Q, K, cos, sin)
  File "/usr/local/lib/python3.10/dist-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/unsloth/kernels/rope_embedding.py", line 159, in fast_rope_embedding
    torch.cuda.current_stream(Q.device).synchronize()
  File "/usr/local/lib/python3.10/dist-packages/torch/cuda/streams.py", line 102, in synchronize
    super().synchronize()
KeyboardInterrupt